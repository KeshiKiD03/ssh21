-----------
-- SSH21 --
-----------

<!---
# Plantilla H1
## Plantilla H2
### Plantilla H3
-->
<!--- <img src="https://phoneky.co.uk/thumbs/screensavers/down/original/linux_3rj131p8.gif" />
-->

⭐️ **PLANTILLA** ⭐️

| 🔥PLANTILLA TALBA❗🔥 | 
| ------------- |
| *Plantilla* |


--------------------------------------------------------------------------------

14.12.21 -- Práctica 13 SSH BASE

Basada en pam21:ldap de manera que permeti l’autenticació d’usuaris unix
locals i usuaris LDAP.

**Necesitamos tanto SSH21:BASE COMO LDAP:GROUP**

● Els containers han de poder executar-se en detach.

**Para hacer esto debemos modificar el ssh base**

**mkdir /run/sshd /usr/sbin/sshd -D**

● Generar el README pertinent i pujar-ho tot al git i a Dockerhub.

-------------------------------------

2. Aprofitar per entendre els conceptes:

● Procés d’instal·lació, claus de host, tipus de claus.

**apt-get update**

**apt-get install openssh-server openssh-client**

**ssh-keygen** --> Genera par de claves

--
keshi@KeshiKiD03:~$ ssh-keygen -tdsa
Generating public/private dsa key pair.
Enter file in which to save the key (/home/keshi/.ssh/id_dsa): 
Enter passphrase (empty for no passphrase): 
Enter same passphrase again: 
Your identification has been saved in /home/keshi/.ssh/id_dsa
Your public key has been saved in /home/keshi/.ssh/id_dsa.pub
The key fingerprint is:
SHA256:F5CAQyRVP43irVXLTDbw+lKtgrOTlVK3B2vjU39I6UY keshi@KeshiKiD03
The key's randomart image is:
+---[DSA 1024]----+
|  .++oo.o.       |
|   .o  ..*       |
|     .. + O      |
|     . o.Oo=     |
|      ..So*+.  . |
|      .+o+=.o E  |
|      ++ooo+ = . |
|      oo oo   = .|
|      ..   . . . |
+----[SHA256]-----+

--

**TENEMOS QUE PASAR LA CLAVE PÚBLICA A AUTHORIZED KEYS DE LA MÁQUINA REMOTA MEDIANTE SCP O SSH-COPY-ID**

**Si la carpeta de .SSH no existe hay que crearla**

unix01@ssh:~$ mkdir .ssh
unix01@ssh:~$ touch .ssh/authorized_keys

--
admin@ip-172-31-85-232:~/.ssh$ scp id_dsa.pub unix01@172.19.0.3:/home/unix01/.ssh/authorized_keys
unix01@172.19.0.3's password:
id_dsa.pub                                         100%  612     1.2MB/s   00:00
admin@ip-172-31-85-232:~/.ssh$
--



--
keshi@KeshiKiD03:~/Documents$ ssh-copy-id unix01@ssh.edt.org
/usr/bin/ssh-copy-id: INFO: attempting to log in with the new key(s), to filter out any that are already installed
/usr/bin/ssh-copy-id: INFO: 3 key(s) remain to be installed -- if you are prompted now it is to install the new keys
unix01@ssh.edt.org's password: 

Number of key(s) added: 3

Now try logging into the machine, with:   "ssh 'unix01@ssh.edt.org'"
and check to make sure that only the key(s) you wanted were added.

keshi@KeshiKiD03:~/Documents$ ssh unix01@ssh.edt.org
Last login: Wed Dec 15 00:26:41 2021 from 172.20.0.1
unix01@ssh:~$ 
--

● Concepte de fingerprint, autenticació host destí.

**ssh guest@i27**

--
The authenticity of host 'i27 (10.200.243.227)' can't be established.
ECDSA key fingerprint is SHA256:N/Bx0WtXgS1RXliXUPxQFckOyooabdz6EetsEdtkC94.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added 'i27,10.200.243.227' (ECDSA) to the list of known hosts.
guest@i27's password: 
Linux i27 5.10.0-8-amd64 #1 SMP Debian 5.10.46-4 (2021-08-03) x86_64

Linux i27 5.10.0-8-amd64 #1 SMP Debian 5.10.46-4 (2021-08-03) x86_64

The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
Last login: Wed Nov 17 08:24:41 2021 from 10.200.243.202


--

Explicación: Cuando el cliente se conecta con el servidor, el servidor dice que la autenticidad del host i27 no puede estar establecida. 
La máquina a la que has llamado, la máquina destino tiene un **fingerprint**. 
Fingerprint vocal.
La máquina en la que se ha conectado le ha dado un **fingerprint** en modo de **HASH**
HASH MD5 y SHA[MEDIDA]

El fingerprint real del servidor te lo tienen que decir para poder conectarse.

El cliente anota el fingerprint del servidor, si se vuelve a abrir el SSH, ya no pide le fingerprint.

El fingerprint se calcula mediante una llave. El **hash** es la clave de host.

Se almacenan en .ssh/known_hosts --> Es donde se almacenan los fingerprints de los hosts

CLIENTE ----------------> SERVIDOR




**vim /etc/hosts**

10.200.243.226 i27




--
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@       WARNING: POSSIBLE DNS SPOOFING DETECTED!          @
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
The ECDSA host key for i27 has changed,
and the key for the corresponding IP address 10.200.243.226
is unknown. This could either mean that
DNS SPOOFING is happening or the IP address for the host
and its host key have changed at the same time.
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@    WARNING: REMOTE HOST IDENTIFICATION HAS CHANGED!     @
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
IT IS POSSIBLE THAT SOMEONE IS DOING SOMETHING NASTY!
Someone could be eavesdropping on you right now (man-in-the-middle attack)!
It is also possible that a host key has just been changed.
The fingerprint for the ECDSA key sent by the remote host is
SHA256:4qz/8/bGbpqZpC8G2j7eUaFrqwF/OvunIxwfsfv37XM.
Please contact your system administrator.
Add correct host key in /root/.ssh/known_hosts to get rid of this message.
Offending ECDSA key in /root/.ssh/known_hosts:1
  remove with:
  ssh-keygen -f "/root/.ssh/known_hosts" -R "i27"
ECDSA host key for i27 has changed and you have requested strict checking.
Host key verification failed.

--

Dice que han habido cambios y que te pueden estar hackeando o escuchando.

La fingerprint enviada del host es diferente a lo que tiene apuntado.


**ssh-keyscan i26**


--

isx36579183@i11:~/Documents/pam21$ ssh-keyscan i26
# i26:22 SSH-2.0-OpenSSH_8.4p1 Debian-5
i26 ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDlFgGZWfp6+uLa6qzmHDg9jT3+FrtA4tSrtrDOcnF1QTOG6FBwhdLA++XziA/PD2T7EsRXqWmtjQ3lU1+ikIyck4g52Q7VOJTlSz1YZRFh4HYCJqFLUz3BATH7scESqXv8NzVcilQy+5KfIQCSYtP55rZ2hcxHNgjEfHFEIjaQrJRwW+D13senMrh+VaFDdZtziiKvvSjwrmLoGbcxBFhQf2jk/b+yBBZhqfwixlpXb4f5lDzNNS+f+jAIA/jPUpSxzMtzwroIaG3CJMnfBQdkd3UjN9T88VBUxvBVC6UbypSRYZsPoRWUuC4iTwRmIHy/qP6zXwXXFz6+VQ1T6HBbXWGpsAApohNVzRgly/APxmm/gvH8XDmNE4Vu9ltQN+nltBi5c8gkTSfhnVGViL9oqdHiCg5+zoaGyt4OEfqUMZXnIKF1ws2BmP9EdNRQg7IOs+N26BMGIBFJo8afFgxqDvrRyOj5R3dcVjMs6jXUHbp+aSjh/s936xdAbU+9Fm8=
# i26:22 SSH-2.0-OpenSSH_8.4p1 Debian-5
i26 ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBP7OkfWoUX+gRX2KyQvPC/5yCC52UUOAzFmyMZrq2gEsbJV+K1XkY6Xc/wbzANH2Plosd86o+xtWz0M9UzvaFd4=
# i26:22 SSH-2.0-OpenSSH_8.4p1 Debian-5
i26 ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAINs01uNs6AU52uwYhNVCBvYihQcSMeTYo1QHRHMT1Wel
# i26:22 SSH-2.0-OpenSSH_8.4p1 Debian-5
# i26:22 SSH-2.0-OpenSSH_8.4p1 Debian-5

--

Dice las claves de host de SSH de i26

Cuando se ha instalado el Openssh-server, se han creado automáticamente las claves de host.

known_hosts --> Es la lista de fingerprints, que el usuario ha dado como aceptables a la hora de entrar. Es decir que ha aceptado el fingerprint del servidor.



**cat ~/.ssh/known_hosts**

--
|1|W6RPlVuD8uqOVw7sLDCyMFKPoPA=|rQ8QEG+54oC1/tPVnPJ7rdgUhbg= ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBMzAza02PRtaaYGcGC5KJCmh1uUReCUBU5V8mcIgOCeTGFlpM5l1n5YO4MxrvOLa5i3gbolZ9hArCD7MYAzRGwY=
|1|ms4ytWDTbvB59PgBA4K5ZN1siME=|o/qR3IPIxeFPbAq0gYowmcJlF30= ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBMzAza02PRtaaYGcGC5KJCmh1uUReCUBU5V8mcIgOCeTGFlpM5l1n5YO4MxrvOLa5i3gbolZ9hArCD7MYAzRGwY=

--

**md5sum /etc/passwd**
--
0cd28cd36e0974a41545b1fb9c2598b1  /etc/passwd

--
Es el hash de todo /etc/passwd


Si se cambia algo se cambia el fingerprint.

--
root@pam:/opt/docker# md5sum /tmp/passwd
0cd28cd36e0974a41545b1fb9c2598b1  /tmp/passwd
root@pam:/opt/docker# md5sum /tmp/passwd
0cd28cd36e0974a41545b1fb9c2598b1  /tmp/passwd
root@pam:/opt/docker# vim /tmp/passwd
root@pam:/opt/docker# md5sum /tmp/passwd
98e0e82968fc92e2fd68ccf4768ed161  /tmp/passwd

--

Checksum --> Retransmitir, de la suma.

Dispersión --> Mucha cantidad de datos y concentras en algo más pequeño. Hay 





Eliminar ultima lines del etc hosts. Entrar a i27:
root@pam:/opt/docker# ssh -o "VisualHostKey yes" guest@i27
: patata
$ su -
:jupiter
# cd /etc/ssh/
# tree









--
Host key fingerprint is SHA256:N/Bx0WtXgS1RXliXUPxQFckOyooabdz6EetsEdtkC94
+---[ECDSA 256]---+
|            .+XO%|
|             ==*+|
|        . o o ++o|
|         = B  o.o|
|      o S.& .. . |
|     . = BoE     |
|      + .o.      |
|     . .o..      |
|        o+       |
+----[SHA256]-----+
guest@i27's password: 
Linux i27 5.10.0-8-amd64 #1 SMP Debian 5.10.46-4 (2021-08-03) x86_64

The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
Last login: Wed Nov 17 09:00:06 2021 from 10.200.243.209
guest@i27:~$ 

--

su - # jupiter

--
.
├── moduli
├── ssh_config
├── ssh_config.d
├── sshd_config
├── sshd_config.d
├── ssh_host_ecdsa_key
├── ssh_host_ecdsa_key.pub
├── ssh_host_ed25519_key
├── ssh_host_ed25519_key.pub
├── ssh_host_rsa_key
└── ssh_host_rsa_key.pub

--

apt-get install mlocate (Lo hace solo el host)

**locate ssh.service**
--
/usr/lib/systemd/system/ssh.service
/usr/lib/systemd/system/sssd-ssh.service
/usr/share/doc/avahi-daemon/examples/sftp-ssh.service
/usr/share/doc/avahi-daemon/examples/ssh.service
/var/lib/systemd/deb-systemd-helper-enabled/ssh.service.dsh-also
/var/lib/systemd/deb-systemd-helper-enabled/sssd-ssh.service.dsh-also
/var/lib/systemd/deb-systemd-helper-enabled/multi-user.target.wants/ssh.service

--

**vim /usr/lib/systemd/system/ssh.service**

--
[Unit]
Description=OpenBSD Secure Shell server
Documentation=man:sshd(8) man:sshd_config(5)
After=network.target auditd.service
ConditionPathExists=!/etc/ssh/sshd_not_to_be_run

[Service]
EnvironmentFile=-/etc/default/ssh
ExecStartPre=/usr/sbin/sshd -t
ExecStart=/usr/sbin/sshd -D $SSHD_OPTS
ExecReload=/usr/sbin/sshd -t
ExecReload=/bin/kill -HUP $MAINPID
KillMode=process
Restart=on-failure
RestartPreventExitStatus=255
Type=notify
RuntimeDirectory=sshd
RuntimeDirectoryMode=0755

[Install]
WantedBy=multi-user.target
Alias=sshd.service

--

Aqui podemos ver los métodos de arranque

-D Se realiza en DETACH

**man ssh-keygen** --> Genera las claves

**ssh-keygen -A** --> Genera una nueva clave DSA.

--
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@    WARNING: REMOTE HOST IDENTIFICATION HAS CHANGED!     @
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
IT IS POSSIBLE THAT SOMEONE IS DOING SOMETHING NASTY!
Someone could be eavesdropping on you right now (man-in-the-middle attack)!
It is also possible that a host key has just been changed.
The fingerprint for the ECDSA key sent by the remote host is
SHA256:Ef7XHKOR9TFY6BAob5Tjo4ekZuH4DVKXh4UbeLhCGKc.
Please contact your system administrator.
Add correct host key in /root/.ssh/known_hosts to get rid of this message.
Offending ECDSA key in /root/.ssh/known_hosts:1
  remove with:
  ssh-keygen -f "/root/.ssh/known_hosts" -R "i27"
ECDSA host key for i27 has changed and you have requested strict checking.
Host key verification failed.

--

Envenenamiento de DNS.

**ssh-keygen -f "/root/.ssh/known_hosts" -R "i27"** --> REALIZAR ESTE COMANDO PARA QUE PODAMOS CONECTARNOS DE NUEVO.

--
# Host i27 found: line 1
/root/.ssh/known_hosts updated.
Original contents retained as /root/.ssh/known_hosts.old

--

--
root@pam:/opt/docker# ssh -o "VisualHostKey yes" guest@i27
The authenticity of host 'i27 (10.200.243.227)' can't be established.
ECDSA key fingerprint is SHA256:Ef7XHKOR9TFY6BAob5Tjo4ekZuH4DVKXh4UbeLhCGKc.
+---[ECDSA 256]---+
| .o.  o o o.. =+ |
| .o. o * B . = .o|
| E.   o & . = o .|
|   . + * O   * o |
|    = = S o o o  |
|   o * o . .     |
|    = o .        |
|     . .         |
|                 |
+----[SHA256]-----+
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added 'i27' (ECDSA) to the list of known hosts.
Warning: the ECDSA host key for 'i27' differs from the key for the IP address '10.200.243.227'
Offending key for IP in /root/.ssh/known_hosts:1
Are you sure you want to continue connecting (yes/no)? yes

--

El fichero de configuración de ssh cliente es

**vim /etc/ssh/ssh_config**

Existen 3 niveles de configuración de cliente:

* /etc/ssh/ssh_config **Se aplican a todos los usuarios, opciones por defecto personalizadas**
* ~/.ssh/config **Un usuario se puede redifinir sus opciones dentro de su home** **Prevale el último**
* opciones de la línea de comandos

El fichero de configuración de ssh servidor es

**vim /etc/ssh/sshd_config**


**ssh -o [OUTPUT] guest@i27**

Aquí se incluyen los parámetros

--
AddKeysToAgent=                    IdentityAgent=
AddressFamily=                     IdentityFile=
BatchMode=                         IgnoreUnknown=
BindAddress=                       Include=
CanonicalDomains=                  IPQoS=
CanonicalizeFallbackLocal=         KbdInteractiveAuthentication=

--

**vim /etc/ssh/sshd_config**

Host * --> Hace referencia a todos los hosts

Host i26 --> Hace referencia a i26i

---

VisualHostKey yes

HashKnownHosts no

--

**ssh -o "VisualHostKey no" guest@i27**

--
root@pam:/etc/ssh# ssh -o "VisualHostKey no" guest@i27
Warning: the ECDSA host key for 'i27' differs from the key for the IP address '10.200.243.227'
Offending key for IP in /root/.ssh/known_hosts:1
Matching host key in /root/.ssh/known_hosts:2
Are you sure you want to continue connecting (yes/no)? 

--

**docker exect -it pam.edt.org /bin/bash**

**su - unix01**

**ssh guest@i27**

**vim .ssh/config**


--
Host i26
	VisualHostKey yes
	PasswordAuthentication no

Host *
	VisualHostKey no
--


Se accede en modo desates.

--
Host i26
	VisualHostKey yes
	PasswordAuthentication no

Host i27
	VisualHostKey yes

Host *
	VisualHostKey no

--

Dentro de guest, guest@i27 sin cerrarlo

**ssh guest@i26**

--
guest@i27:~$ ssh guest@i26
The authenticity of host 'i26 (10.200.243.226)' can't be established.
ECDSA key fingerprint is SHA256:4qz/8/bGbpqZpC8G2j7eUaFrqwF/OvunIxwfsfv37XM.
+---[ECDSA 256]---+
|                 |
|                 |
|          .      |
|        .. .     |
|    . . So.      |
|     =o.oo       |
|     +=+=o..     |
|    ..**B=o+=  oE|
|    .+BXB@OBo...=|
+----[SHA256]-----+
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added 'i26,10.200.243.226' (ECDSA) to the list of known hosts.
guest@i26: Permission denied (publickey,password).

--

**ssh -d**

**ssh -v guest@i27**

--
OpenSSH_8.4p1 Debian-5, OpenSSL 1.1.1k  25 Mar 2021
debug1: Reading configuration data /etc/ssh/ssh_config
debug1: /etc/ssh/ssh_config line 19: include /etc/ssh/ssh_config.d/*.conf matched no files
debug1: /etc/ssh/ssh_config line 21: Applying options for *
debug1: Connecting to i27 [10.200.243.227] port 22.
debug1: Connection established.
debug1: identity file /home/unix01/.ssh/id_rsa type -1
debug1: identity file /home/unix01/.ssh/id_rsa-cert type -1
debug1: identity file /home/unix01/.ssh/id_dsa type -1
debug1: identity file /home/unix01/.ssh/id_dsa-cert type -1
debug1: identity file /home/unix01/.ssh/id_ecdsa type -1
debug1: identity file /home/unix01/.ssh/id_ecdsa-cert type -1
debug1: identity file /home/unix01/.ssh/id_ecdsa_sk type -1
debug1: identity file /home/unix01/.ssh/id_ecdsa_sk-cert type -1
debug1: identity file /home/unix01/.ssh/id_ed25519 type -1
debug1: identity file /home/unix01/.ssh/id_ed25519-cert type -1
debug1: identity file /home/unix01/.ssh/id_ed25519_sk type -1
debug1: identity file /home/unix01/.ssh/id_ed25519_sk-cert type -1
debug1: identity file /home/unix01/.ssh/id_xmss type -1
debug1: identity file /home/unix01/.ssh/id_xmss-cert type -1
debug1: Local version string SSH-2.0-OpenSSH_8.4p1 Debian-5
debug1: Remote protocol version 2.0, remote software version OpenSSH_8.4p1 Debian-5
debug1: match: OpenSSH_8.4p1 Debian-5 pat OpenSSH* compat 0x04000000
debug1: Authenticating to i27:22 as 'guest'
debug1: SSH2_MSG_KEXINIT sent
debug1: SSH2_MSG_KEXINIT received
debug1: kex: algorithm: curve25519-sha256
debug1: kex: host key algorithm: ecdsa-sha2-nistp256
debug1: kex: server->client cipher: chacha20-poly1305@openssh.com MAC: <implicit> compression: none
debug1: kex: client->server cipher: chacha20-poly1305@openssh.com MAC: <implicit> compression: none
debug1: expecting SSH2_MSG_KEX_ECDH_REPLY
debug1: Server host key: ecdsa-sha2-nistp256 SHA256:Ef7XHKOR9TFY6BAob5Tjo4ekZuH4DVKXh4UbeLhCGKc
debug1: Host 'i27' is known and matches the ECDSA host key.
debug1: Found key in /home/unix01/.ssh/known_hosts:1
Host key fingerprint is SHA256:Ef7XHKOR9TFY6BAob5Tjo4ekZuH4DVKXh4UbeLhCGKc
+---[ECDSA 256]---+
| .o.  o o o.. =+ |
| .o. o * B . = .o|
| E.   o & . = o .|
|   . + * O   * o |
|    = = S o o o  |
|   o * o . .     |
|    = o .        |
|     . .         |
|                 |
+----[SHA256]-----+
debug1: rekey out after 134217728 blocks
debug1: SSH2_MSG_NEWKEYS sent
debug1: expecting SSH2_MSG_NEWKEYS
debug1: SSH2_MSG_NEWKEYS received
debug1: rekey in after 134217728 blocks
debug1: Will attempt key: /home/unix01/.ssh/id_rsa 
debug1: Will attempt key: /home/unix01/.ssh/id_dsa 
debug1: Will attempt key: /home/unix01/.ssh/id_ecdsa 
debug1: Will attempt key: /home/unix01/.ssh/id_ecdsa_sk 
debug1: Will attempt key: /home/unix01/.ssh/id_ed25519 
debug1: Will attempt key: /home/unix01/.ssh/id_ed25519_sk 
debug1: Will attempt key: /home/unix01/.ssh/id_xmss 
debug1: SSH2_MSG_EXT_INFO received
debug1: kex_input_ext_info: server-sig-algs=<ssh-ed25519,sk-ssh-ed25519@openssh.com,ssh-rsa,rsa-sha2-256,rsa-sha2-512,ssh-dss,ecdsa-sha2-nistp256,ecdsa-sha2-nistp384,ecdsa-sha2-nistp521,sk-ecdsa-sha2-nistp256@openssh.com,webauthn-sk-ecdsa-sha2-nistp256@openssh.com>
debug1: SSH2_MSG_SERVICE_ACCEPT received
debug1: Authentications that can continue: publickey,password
debug1: Next authentication method: publickey
debug1: Trying private key: /home/unix01/.ssh/id_rsa
debug1: Trying private key: /home/unix01/.ssh/id_dsa
debug1: Trying private key: /home/unix01/.ssh/id_ecdsa
debug1: Trying private key: /home/unix01/.ssh/id_ecdsa_sk
debug1: Trying private key: /home/unix01/.ssh/id_ed25519
debug1: Trying private key: /home/unix01/.ssh/id_ed25519_sk
debug1: Trying private key: /home/unix01/.ssh/id_xmss
debug1: Next authentication method: password

--

Guest password.

debug1: SSH2_MSG_SERVICE_ACCEPT received
debug1: Authentications that can continue: publickey,password
debug1: Next authentication method: publickey




-------------------------------------------------------------------------------- 







● Configuració SSH client.

**SCP** Secure Copy (Copia un fichero a remoto).

--
scp copies files between hosts on a network. It uses ssh(1) for data transfer, and uses the same authentication and provides the same security as ssh(1). Unlike rcp(1), scp will ask for passwords or passphrases if they are needed for authentication.

--

--
admin@ip-172-31-85-232:~/.ssh$ scp id_dsa.pub unix01@172.19.0.3:/home/unix01/.ssh/authorized_keys
unix01@172.19.0.3's password:
id_dsa.pub                                         100%  612     1.2MB/s   00:00
admin@ip-172-31-85-232:~/.ssh$
--

**SFTP** Secure file transfer program.

--
sftp is an interactive file transfer program, similar to ftp(1), which performs all operations over an encrypted ssh(1) transport. It may also use many features of ssh, such as public key authentication and compression. sftp connects and logs into the specified host, then enters an interactive command mode.

--

**SSHFS** Filesystem client base on SSH.

--
SSHFS (Secure SHell FileSystem) is a file system for Linux (and other operating systems
with a FUSE implementation, such as Mac OS X or FreeBSD) capable of operating on files on a remote computer using just a secure shell login on the remote computer. On the local
computer where the SSHFS is mounted, the implementation makes use of the FUSE (Filesystem in Userspace) kernel module. The practical effect of this is that the end user can seamlessly interact with remote files being securely served over SSH just as if they were local files on his/her computer. On the remote computer the SFTP subsystem of SSH is used.

--

--

--


**SSH-ADD** Añade una identidad a la clave privada para la autenticación.

--
ssh-add adds private key identities to the authentication agent, ssh-agent(1). When
run without arguments,
it adds the files ~/.ssh/id_rsa, ~/.ssh/id_dsa, ~/.ssh/id_ecdsa and ~/.ssh/identity. After
loading a private key, ssh-add will try to load corresponding certificate information from the
filename obtained by oppending -cert.pub to the name of the private key file. Alternative file
names can be given on the command line.
--

--
[pere@hp01 ~]$ ssh-add
Enter passphrase for /home/pere/.ssh/id_rsa:
Identity added: /home/pere/.ssh/id_rsa (/home/pere/.ssh/id_rsa)

--

--
[pere@hp01 ~]$ ssh-copy-id marta@localhost
/bin/ssh-copy-id: INFO: attempting to log in with the new key(s), to filter out any that are
...
--

--
$ eval “$(ssh-agent -s)”

Engegar el daemon que permet tenir en memória les claus privades

$ ssh-add .ssh/id_ecdsa

Enter passphrase for .ssh/id_ecdsa: 
Identity added: .ssh/id_ecdsa (pau@i04)
Afegim la clau a memória.

ssh-add -l 

Llistat de claus carregades en memória

--

**SSH-COPY-ID**

--
keshi@KeshiKiD03:~/Documents$ ssh-copy-id unix01@ssh.edt.org
/usr/bin/ssh-copy-id: INFO: attempting to log in with the new key(s), to filter out any that are already installed
/usr/bin/ssh-copy-id: INFO: 3 key(s) remain to be installed -- if you are prompted now it is to install the new keys
unix01@ssh.edt.org's password: 

Number of key(s) added: 3

Now try logging into the machine, with:   "ssh 'unix01@ssh.edt.org'"
and check to make sure that only the key(s) you wanted were added.

keshi@KeshiKiD03:~/Documents$ ssh unix01@ssh.edt.org
Last login: Wed Dec 15 00:26:41 2021 from 172.20.0.1
unix01@ssh:~$ 
--

**SSH-KEYSCAN**

--
keshi@KeshiKiD03:~/Documents$ ssh-keyscan KeshiKiD03
# KeshiKiD03:22 SSH-2.0-OpenSSH_8.2p1 Ubuntu-4ubuntu0.3
keshikid03 ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBCi1uPqxEphsd1maf3YI92ITQ+qm9Nf0iKMfmotpRp57/PpM4xvg6EalHRpcoqjKn7GKlS7KYISVXhhZDwtFyhU=
# KeshiKiD03:22 SSH-2.0-OpenSSH_8.2p1 Ubuntu-4ubuntu0.3
keshikid03 ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQC3PmT3mYqvI6Zr18Q1aLsHxwud0L+8X2Ife5Ycu1VKQr9qV4qj0raURKh55SC1XSWKz6I733LoJALqLt0c/hyLspOMUSHX3UbaZcjkf507N48s18qiPq+LkGfHseRKGrkRnYyRiJ0YZf7eipuYtG9NP7mH7JETV4H++vV/PxneX1nn6WzI52sIEMpkYwC6VqZIo1Bk9a39euCK/nV/5zr6cpJKpq5ygrLdJ4NSzqOAwTxo66rVxRL+rxeEBQKTT9MXDyLEM0+knpGw7H3cyHCS9BFJaaZH4lnI3IIyIOSGO9FUhLm0DDoCb1S9b6OE/POC6TxrpJG/HrTfHINbxvQZXrpUrSLmnvy7GvBLgZIpSjwqbMPFEQ8g7uATJXLfhVEDmRQpfI+qNmKC4PVgzNJkYTckUpy5Nh9b7PDM5BOxzDPMx3prQkuJ/j6wz4rqpYuVeH6I292V4dcaD+QzK5gJxZkB83ucw7S7JhXI2pmrELqDTvCfEHsRQWUHIBFX5Kk=
# KeshiKiD03:22 SSH-2.0-OpenSSH_8.2p1 Ubuntu-4ubuntu0.3
keshikid03 ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAIGyTOwTOGQUnJu0LoVDk6AYfo0jB+AqsD1vyNhy5jgYo
# KeshiKiD03:22 SSH-2.0-OpenSSH_8.2p1 Ubuntu-4ubuntu0.3
# KeshiKiD03:22 SSH-2.0-OpenSSH_8.2p1 Ubuntu-4ubuntu0.3
--






● Configuració SSH servidor.

Listen

Bind

Pont 

Interficie

Els ports son 16 bits.

**ps ax**

#Dominar las ordenes

nmap

ss --> Versión moderna del Netstat

netstat

ss -l

--
Netid   State    Recv-Q    Send-Q               Local Address:Port         Peer Address:Port   Process   
nl      UNCONN   0         0                             rtnl:kernel                   *                 
nl      UNCONN   0         0                             rtnl:3510                     *                 
nl      UNCONN   4352      0                          tcpdiag:ss/132                   *                 
nl      UNCONN   768       0                          tcpdiag:kernel                   *                 
nl      UNCONN   0         0                             xfrm:kernel                   *                 
nl      UNCONN   0         0                            audit:kernel                   *                 
nl      UNCONN   0         0                        fiblookup:kernel                   *                 
nl      UNCONN   0         0                              nft:kernel                   *                 
nl      UNCONN   0         0                           uevent:kernel                   *                 
nl      UNCONN   0         0                             genl:kernel                   *                 
u_str   LISTEN   0         128          /var/run/nslcd/socket 69845                   * 0                
udp     UNCONN   0         0                       127.0.0.11:38872             0.0.0.0:*                
tcp     LISTEN   0         4096                    127.0.0.11:46761             0.0.0.0:*                
tcp     LISTEN   0         128                        0.0.0.0:22                0.0.0.0:*                
tcp     LISTEN   0         128                           [::]:22                   [::]:*  
--

0.0.0.0 --> Para todas las interfícies

0.0.0.0:* --> Todos los clientes se pueden conectar

0.0.0.0:22 --> Está escuchando por el puerto 22

ss -lt --> Listen TCP

ss -lu --> Listen UDP

ss -lx --> Listen Unix

ss -u

bootpc -->

bootps -->

ss -un

68 --> Puertos DHCP

67 --> Puertos DHCP

ss -x --> Sockets unix

-----------------

find / -type s -ls 2> /dev/null

-----------------

ss -lt --> Todo de TCP

ss -lx --> te lo muestra todo de UNIX

-----------------

cd /etc/ssh 

ls -l 

Son claves del HOST privada y pública 

-rw------- 1 root root   1385 Nov 18 11:21 ssh_host_dsa_key
-rw-r--r-- 1 root root    606 Nov 18 11:21 ssh_host_dsa_key.pub
-rw------- 1 root root    513 Nov 18 11:20 ssh_host_ecdsa_key
-rw-r--r-- 1 root root    179 Nov 18 11:20 ssh_host_ecdsa_key.pub
-rw------- 1 root root    411 Nov 18 11:20 ssh_host_ed25519_key
-rw-r--r-- 1 root root     99 Nov 18 11:20 ssh_host_ed25519_key.pub
-rw------- 1 root root   2602 Nov 18 11:20 ssh_host_rsa_key
-rw-r--r-- 1 root root    571 Nov 18 11:20 ssh_host_rsa_key.pub


------------------------------------------------------------------

vim sshd_config

Port 22

ListenAddress 0.0.0.0

--

Port 2022

ListenAddress 127.0.0.1

--


localhost --> ::1 Ipv6

127.0.0.1 IPv4

--------------

reiniciar el servicio

kill -1 [numero de proceso]

-1 reinicializar sithub

nmap localhost

-------------------

Decirle que IP si

0.0.0.0 --> Todas las IP que tenga este HOST.

ssh -p [2022] unix@172.19.0.3 --> No está encendido el container




Cambiar el sshd_config


**Probar la conectividad**

isx36579183@i11:~/Documents/ssh21/ssh21:base$ ssh -p 2022 unix01@172.19.0.3
The authenticity of host '[172.19.0.3]:2022 ([172.19.0.3]:2022)' can't be established.
ECDSA key fingerprint is SHA256:jq6jYl3d6SoyiJeSISMMsvOJHSaOLRA+PXsROlzXH0E.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added '[172.19.0.3]:2022' (ECDSA) to the list of known hosts.
unix01@172.19.0.3's password: 
unix01@ssh:~$ 

--
# Authentication:

#LoginGraceTime 2m
#PermitRootLogin prohibit-password
#StrictModes yes
#MaxAuthTries 6 --> Maximos intentos
#MaxSessions 10 --> Maximas sesiones abiertas

#PubkeyAuthentication yes --> Explica que se puede iniciar con claves públicas

--

Son directivas de configuración del SSHD

#LoginGraceTime 2m --> El servidor se desconecta después de este tiempo si el usuario no ha iniciado sesión correctamente. Default 120 s.

#PermitRootLogin prohibit-password --> No se permite acceder al SSH como ROOT. Permit LOGIN NO

#StrictModes yes --> Especifica el tipo de modo de ficheros. [falta rellenar]

# PrintMotd --> Es el mensaje del dia para decirles a los empleados.

Con la / y se busca y n de next

Vim /etc/motd --> Especificar el fichero del mensaje del día

/etc/init.d/ssh restart

Probar el SSH

--
isx36579183@i11:~/Documents/ssh21/ssh21:base$ ssh -p 2022 unix01@172.19.0.3
unix01@172.19.0.3's password: 
Last login: Thu Nov 18 12:08:25 2021 from 172.19.0.1

The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.

Portat bé o al carré
unix01@ssh:~$ 

--


banner --> Encabezado

Match host 172.19.0.1

	banner /etc/banner
	
--

Match user unix01
	banner /etc/banner-user01
	PasswordAuthentication yes
	
Match user unix02
	banner /etc/banner-user02
	PasswordAuthentication no

Cuando se conecte unix01 se conectaran unas normas y cuando se conecte unix02 se conectarán otras



----------------------

AllowUsers / DenyUsers

Permite una lista de usuarios que permite/denegar acceder por SSH.


The
             allow/deny users directives are processed in the following order: DenyUsers, AllowUsers.


----------------------

Ejercicio

man pam_access

man access.conf --> Como funciona el acecso

Se pueda iniciar todos los usuarios menos unix02

man pam_listfile 



















--------------------------------------------------------------------


Conceptos de REDES












**apt-get update**

**apt-get update**

**apt-get update**

**apt-get update**

**apt-get update**

**apt-get update**

**apt-get update**

**apt-get update**

**apt-get update**

**apt-get update**

**apt-get update**

**apt-get update**

**apt-get update**

**apt-get update**

**apt-get update**

**apt-get update**

**apt-get update**

**apt-get update**

**apt-get update**

**apt-get update**

**apt-get update**

**apt-get update**

**apt-get update**

**apt-get update**

**apt-get update**

**apt-get update**

**apt-get update**

**apt-get update**

**apt-get update**











**apt-get update**

**apt-get install openssh-server**

**yes**

**/usr/sbin/sshd (Daemon)** -D para DETACH

**ssh guest@i27**

**patata**

--
The authenticity of host 'i27 (10.200.243.227)' can't be established.
ECDSA key fingerprint is SHA256:N/Bx0WtXgS1RXliXUPxQFckOyooabdz6EetsEdtkC94.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added 'i27,10.200.243.227' (ECDSA) to the list of known hosts.
guest@i27's password: 
Linux i27 5.10.0-8-amd64 #1 SMP Debian 5.10.46-4 (2021-08-03) x86_64

Linux i27 5.10.0-8-amd64 #1 SMP Debian 5.10.46-4 (2021-08-03) x86_64

The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
Last login: Wed Nov 17 08:24:41 2021 from 10.200.243.202


--

Explicación: Cuando el cliente se conecta con el servidor, el servidor dice que la autenticidad del host i27 no puede estar establecida. 
La máquina a la que has llamado, la máquina destino tiene un **fingerprint**. 
Fingerprint vocal.
La máquina en la que se ha conectado le ha dado un **fingerprint** en modo de **HASH**
HASH MD5 y SHA[MEDIDA]
El fingerprint real del servidor te lo tienen que decir para poder conectarse.

El cliente anota el fingerprint del servidor, si se vuelve a abrir el SSH, ya no pide le fingerprint.

El fingerprint se calcula mediante una llave. El **hash** es la clave de host.

Se almacenan en .ssh/known_hosts --> Es donde se almacenan los fingerprints de los hosts

CLIENTE ----------------> SERVIDOR

Sshclient


**vim /etc/hosts**

10.200.243.226 i27

--
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@       WARNING: POSSIBLE DNS SPOOFING DETECTED!          @
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
The ECDSA host key for i27 has changed,
and the key for the corresponding IP address 10.200.243.226
is unknown. This could either mean that
DNS SPOOFING is happening or the IP address for the host
and its host key have changed at the same time.
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@    WARNING: REMOTE HOST IDENTIFICATION HAS CHANGED!     @
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
IT IS POSSIBLE THAT SOMEONE IS DOING SOMETHING NASTY!
Someone could be eavesdropping on you right now (man-in-the-middle attack)!
It is also possible that a host key has just been changed.
The fingerprint for the ECDSA key sent by the remote host is
SHA256:4qz/8/bGbpqZpC8G2j7eUaFrqwF/OvunIxwfsfv37XM.
Please contact your system administrator.
Add correct host key in /root/.ssh/known_hosts to get rid of this message.
Offending ECDSA key in /root/.ssh/known_hosts:1
  remove with:
  ssh-keygen -f "/root/.ssh/known_hosts" -R "i27"
ECDSA host key for i27 has changed and you have requested strict checking.
Host key verification failed.

--

Dice que han habido cambios y que te pueden estar hackeando o escuchando.

La fingerprint enviada del host es diferente a lo que tiene apuntado.


**ssh-keyscan i26**


--

isx36579183@i11:~/Documents/pam21$ ssh-keyscan i26
# i26:22 SSH-2.0-OpenSSH_8.4p1 Debian-5
i26 ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABgQDlFgGZWfp6+uLa6qzmHDg9jT3+FrtA4tSrtrDOcnF1QTOG6FBwhdLA++XziA/PD2T7EsRXqWmtjQ3lU1+ikIyck4g52Q7VOJTlSz1YZRFh4HYCJqFLUz3BATH7scESqXv8NzVcilQy+5KfIQCSYtP55rZ2hcxHNgjEfHFEIjaQrJRwW+D13senMrh+VaFDdZtziiKvvSjwrmLoGbcxBFhQf2jk/b+yBBZhqfwixlpXb4f5lDzNNS+f+jAIA/jPUpSxzMtzwroIaG3CJMnfBQdkd3UjN9T88VBUxvBVC6UbypSRYZsPoRWUuC4iTwRmIHy/qP6zXwXXFz6+VQ1T6HBbXWGpsAApohNVzRgly/APxmm/gvH8XDmNE4Vu9ltQN+nltBi5c8gkTSfhnVGViL9oqdHiCg5+zoaGyt4OEfqUMZXnIKF1ws2BmP9EdNRQg7IOs+N26BMGIBFJo8afFgxqDvrRyOj5R3dcVjMs6jXUHbp+aSjh/s936xdAbU+9Fm8=
# i26:22 SSH-2.0-OpenSSH_8.4p1 Debian-5
i26 ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBP7OkfWoUX+gRX2KyQvPC/5yCC52UUOAzFmyMZrq2gEsbJV+K1XkY6Xc/wbzANH2Plosd86o+xtWz0M9UzvaFd4=
# i26:22 SSH-2.0-OpenSSH_8.4p1 Debian-5
i26 ssh-ed25519 AAAAC3NzaC1lZDI1NTE5AAAAINs01uNs6AU52uwYhNVCBvYihQcSMeTYo1QHRHMT1Wel
# i26:22 SSH-2.0-OpenSSH_8.4p1 Debian-5
# i26:22 SSH-2.0-OpenSSH_8.4p1 Debian-5

--

Dice las claves de host de SSH de i26

Cuando se ha instalado el Openssh-server, se han creado automáticamente las claves de host.

known_hosts --> Es la lista de fingerprints, que el usuario ha dado como aceptables a la hora de entrar. Es decir que ha aceptado el fingerprint del servidor.

**cat ~/.ssh/known_hosts**

--
|1|W6RPlVuD8uqOVw7sLDCyMFKPoPA=|rQ8QEG+54oC1/tPVnPJ7rdgUhbg= ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBMzAza02PRtaaYGcGC5KJCmh1uUReCUBU5V8mcIgOCeTGFlpM5l1n5YO4MxrvOLa5i3gbolZ9hArCD7MYAzRGwY=
|1|ms4ytWDTbvB59PgBA4K5ZN1siME=|o/qR3IPIxeFPbAq0gYowmcJlF30= ecdsa-sha2-nistp256 AAAAE2VjZHNhLXNoYTItbmlzdHAyNTYAAAAIbmlzdHAyNTYAAABBBMzAza02PRtaaYGcGC5KJCmh1uUReCUBU5V8mcIgOCeTGFlpM5l1n5YO4MxrvOLa5i3gbolZ9hArCD7MYAzRGwY=

--

**md5sum /etc/passwd**
--
0cd28cd36e0974a41545b1fb9c2598b1  /etc/passwd

--
Es el hash de todo /etc/passwd


Si se cambia algo se cambia el fingerprint.

--
root@pam:/opt/docker# md5sum /tmp/passwd
0cd28cd36e0974a41545b1fb9c2598b1  /tmp/passwd
root@pam:/opt/docker# md5sum /tmp/passwd
0cd28cd36e0974a41545b1fb9c2598b1  /tmp/passwd
root@pam:/opt/docker# vim /tmp/passwd
root@pam:/opt/docker# md5sum /tmp/passwd
98e0e82968fc92e2fd68ccf4768ed161  /tmp/passwd

--

Checksum --> Retransmitir, de la suma.

Dispersión --> Mucha cantidad de datos y concentras en algo más pequeño. Hay 

Eliminar ultima lines del etc hosts. Entrar a i27:
root@pam:/opt/docker# ssh -o "VisualHostKey yes" guest@i27
: patata
$ su -
:jupiter
# cd /etc/ssh/
# tree


--
Host key fingerprint is SHA256:N/Bx0WtXgS1RXliXUPxQFckOyooabdz6EetsEdtkC94
+---[ECDSA 256]---+
|            .+XO%|
|             ==*+|
|        . o o ++o|
|         = B  o.o|
|      o S.& .. . |
|     . = BoE     |
|      + .o.      |
|     . .o..      |
|        o+       |
+----[SHA256]-----+
guest@i27's password: 
Linux i27 5.10.0-8-amd64 #1 SMP Debian 5.10.46-4 (2021-08-03) x86_64

The programs included with the Debian GNU/Linux system are free software;
the exact distribution terms for each program are described in the
individual files in /usr/share/doc/*/copyright.

Debian GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
Last login: Wed Nov 17 09:00:06 2021 from 10.200.243.209
guest@i27:~$ 

--

su - # jupiter

--
.
├── moduli
├── ssh_config
├── ssh_config.d
├── sshd_config
├── sshd_config.d
├── ssh_host_ecdsa_key
├── ssh_host_ecdsa_key.pub
├── ssh_host_ed25519_key
├── ssh_host_ed25519_key.pub
├── ssh_host_rsa_key
└── ssh_host_rsa_key.pub

--

apt-get install mlocate (Lo hace solo el host)

**locate ssh.service**
--
/usr/lib/systemd/system/ssh.service
/usr/lib/systemd/system/sssd-ssh.service
/usr/share/doc/avahi-daemon/examples/sftp-ssh.service
/usr/share/doc/avahi-daemon/examples/ssh.service
/var/lib/systemd/deb-systemd-helper-enabled/ssh.service.dsh-also
/var/lib/systemd/deb-systemd-helper-enabled/sssd-ssh.service.dsh-also
/var/lib/systemd/deb-systemd-helper-enabled/multi-user.target.wants/ssh.service

--

**vim /usr/lib/systemd/system/ssh.service**

--
[Unit]
Description=OpenBSD Secure Shell server
Documentation=man:sshd(8) man:sshd_config(5)
After=network.target auditd.service
ConditionPathExists=!/etc/ssh/sshd_not_to_be_run

[Service]
EnvironmentFile=-/etc/default/ssh
ExecStartPre=/usr/sbin/sshd -t
ExecStart=/usr/sbin/sshd -D $SSHD_OPTS
ExecReload=/usr/sbin/sshd -t
ExecReload=/bin/kill -HUP $MAINPID
KillMode=process
Restart=on-failure
RestartPreventExitStatus=255
Type=notify
RuntimeDirectory=sshd
RuntimeDirectoryMode=0755

[Install]
WantedBy=multi-user.target
Alias=sshd.service

--

Aqui podemos ver los métodos de arranque

-D Se realiza en DETACH

**man ssh-keygen** --> Genera las claves

**ssh-keygen -A** --> Genera una nueva clave DSA.

--
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
@    WARNING: REMOTE HOST IDENTIFICATION HAS CHANGED!     @
@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@@
IT IS POSSIBLE THAT SOMEONE IS DOING SOMETHING NASTY!
Someone could be eavesdropping on you right now (man-in-the-middle attack)!
It is also possible that a host key has just been changed.
The fingerprint for the ECDSA key sent by the remote host is
SHA256:Ef7XHKOR9TFY6BAob5Tjo4ekZuH4DVKXh4UbeLhCGKc.
Please contact your system administrator.
Add correct host key in /root/.ssh/known_hosts to get rid of this message.
Offending ECDSA key in /root/.ssh/known_hosts:1
  remove with:
  ssh-keygen -f "/root/.ssh/known_hosts" -R "i27"
ECDSA host key for i27 has changed and you have requested strict checking.
Host key verification failed.

--

Envenenamiento de DNS.

**ssh-keygen -f "/root/.ssh/known_hosts" -R "i27"** --> REALIZAR ESTE COMANDO PARA QUE PODAMOS CONECTARNOS DE NUEVO.

--
# Host i27 found: line 1
/root/.ssh/known_hosts updated.
Original contents retained as /root/.ssh/known_hosts.old

--

--
root@pam:/opt/docker# ssh -o "VisualHostKey yes" guest@i27
The authenticity of host 'i27 (10.200.243.227)' can't be established.
ECDSA key fingerprint is SHA256:Ef7XHKOR9TFY6BAob5Tjo4ekZuH4DVKXh4UbeLhCGKc.
+---[ECDSA 256]---+
| .o.  o o o.. =+ |
| .o. o * B . = .o|
| E.   o & . = o .|
|   . + * O   * o |
|    = = S o o o  |
|   o * o . .     |
|    = o .        |
|     . .         |
|                 |
+----[SHA256]-----+
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added 'i27' (ECDSA) to the list of known hosts.
Warning: the ECDSA host key for 'i27' differs from the key for the IP address '10.200.243.227'
Offending key for IP in /root/.ssh/known_hosts:1
Are you sure you want to continue connecting (yes/no)? yes

--

El fichero de configuración de ssh cliente es

**vim /etc/ssh/ssh_config**

Existen 3 niveles de configuración de cliente:

* /etc/ssh/ssh_config **Se aplican a todos los usuarios, opciones por defecto personalizadas**
* ~/.ssh/config **Un usuario se puede redifinir sus opciones dentro de su home** **Prevale el último**
* opciones de la línea de comandos

El fichero de configuración de ssh servidor es

**vim /etc/ssh/sshd_config**


**ssh -o [OUTPUT] guest@i27**

Aquí se incluyen los parámetros

--
AddKeysToAgent=                    IdentityAgent=
AddressFamily=                     IdentityFile=
BatchMode=                         IgnoreUnknown=
BindAddress=                       Include=
CanonicalDomains=                  IPQoS=
CanonicalizeFallbackLocal=         KbdInteractiveAuthentication=

--

**vim /etc/ssh/sshd_config**

Host * --> Hace referencia a todos los hosts

Host i26 --> Hace referencia a i26i

---

VisualHostKey yes

HashKnownHosts no

--

**ssh -o "VisualHostKey no" guest@i27**

--
root@pam:/etc/ssh# ssh -o "VisualHostKey no" guest@i27
Warning: the ECDSA host key for 'i27' differs from the key for the IP address '10.200.243.227'
Offending key for IP in /root/.ssh/known_hosts:1
Matching host key in /root/.ssh/known_hosts:2
Are you sure you want to continue connecting (yes/no)? 

--

**docker exect -it pam.edt.org /bin/bash**

**su - unix01**

**ssh guest@i27**

**vim .ssh/config**


--
Host i26
	VisualHostKey yes
	PasswordAuthentication no

Host *
	VisualHostKey no
--


Se accede en modo desates.

--
Host i26
	VisualHostKey yes
	PasswordAuthentication no

Host i27
	VisualHostKey yes

Host *
	VisualHostKey no

--

Dentro de guest, guest@i27 sin cerrarlo

**ssh guest@i26**

--
guest@i27:~$ ssh guest@i26
The authenticity of host 'i26 (10.200.243.226)' can't be established.
ECDSA key fingerprint is SHA256:4qz/8/bGbpqZpC8G2j7eUaFrqwF/OvunIxwfsfv37XM.
+---[ECDSA 256]---+
|                 |
|                 |
|          .      |
|        .. .     |
|    . . So.      |
|     =o.oo       |
|     +=+=o..     |
|    ..**B=o+=  oE|
|    .+BXB@OBo...=|
+----[SHA256]-----+
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
Warning: Permanently added 'i26,10.200.243.226' (ECDSA) to the list of known hosts.
guest@i26: Permission denied (publickey,password).

--

**ssh -d**

**ssh -v guest@i27**

--
OpenSSH_8.4p1 Debian-5, OpenSSL 1.1.1k  25 Mar 2021
debug1: Reading configuration data /etc/ssh/ssh_config
debug1: /etc/ssh/ssh_config line 19: include /etc/ssh/ssh_config.d/*.conf matched no files
debug1: /etc/ssh/ssh_config line 21: Applying options for *
debug1: Connecting to i27 [10.200.243.227] port 22.
debug1: Connection established.
debug1: identity file /home/unix01/.ssh/id_rsa type -1
debug1: identity file /home/unix01/.ssh/id_rsa-cert type -1
debug1: identity file /home/unix01/.ssh/id_dsa type -1
debug1: identity file /home/unix01/.ssh/id_dsa-cert type -1
debug1: identity file /home/unix01/.ssh/id_ecdsa type -1
debug1: identity file /home/unix01/.ssh/id_ecdsa-cert type -1
debug1: identity file /home/unix01/.ssh/id_ecdsa_sk type -1
debug1: identity file /home/unix01/.ssh/id_ecdsa_sk-cert type -1
debug1: identity file /home/unix01/.ssh/id_ed25519 type -1
debug1: identity file /home/unix01/.ssh/id_ed25519-cert type -1
debug1: identity file /home/unix01/.ssh/id_ed25519_sk type -1
debug1: identity file /home/unix01/.ssh/id_ed25519_sk-cert type -1
debug1: identity file /home/unix01/.ssh/id_xmss type -1
debug1: identity file /home/unix01/.ssh/id_xmss-cert type -1
debug1: Local version string SSH-2.0-OpenSSH_8.4p1 Debian-5
debug1: Remote protocol version 2.0, remote software version OpenSSH_8.4p1 Debian-5
debug1: match: OpenSSH_8.4p1 Debian-5 pat OpenSSH* compat 0x04000000
debug1: Authenticating to i27:22 as 'guest'
debug1: SSH2_MSG_KEXINIT sent
debug1: SSH2_MSG_KEXINIT received
debug1: kex: algorithm: curve25519-sha256
debug1: kex: host key algorithm: ecdsa-sha2-nistp256
debug1: kex: server->client cipher: chacha20-poly1305@openssh.com MAC: <implicit> compression: none
debug1: kex: client->server cipher: chacha20-poly1305@openssh.com MAC: <implicit> compression: none
debug1: expecting SSH2_MSG_KEX_ECDH_REPLY
debug1: Server host key: ecdsa-sha2-nistp256 SHA256:Ef7XHKOR9TFY6BAob5Tjo4ekZuH4DVKXh4UbeLhCGKc
debug1: Host 'i27' is known and matches the ECDSA host key.
debug1: Found key in /home/unix01/.ssh/known_hosts:1
Host key fingerprint is SHA256:Ef7XHKOR9TFY6BAob5Tjo4ekZuH4DVKXh4UbeLhCGKc
+---[ECDSA 256]---+
| .o.  o o o.. =+ |
| .o. o * B . = .o|
| E.   o & . = o .|
|   . + * O   * o |
|    = = S o o o  |
|   o * o . .     |
|    = o .        |
|     . .         |
|                 |
+----[SHA256]-----+
debug1: rekey out after 134217728 blocks
debug1: SSH2_MSG_NEWKEYS sent
debug1: expecting SSH2_MSG_NEWKEYS
debug1: SSH2_MSG_NEWKEYS received
debug1: rekey in after 134217728 blocks
debug1: Will attempt key: /home/unix01/.ssh/id_rsa 
debug1: Will attempt key: /home/unix01/.ssh/id_dsa 
debug1: Will attempt key: /home/unix01/.ssh/id_ecdsa 
debug1: Will attempt key: /home/unix01/.ssh/id_ecdsa_sk 
debug1: Will attempt key: /home/unix01/.ssh/id_ed25519 
debug1: Will attempt key: /home/unix01/.ssh/id_ed25519_sk 
debug1: Will attempt key: /home/unix01/.ssh/id_xmss 
debug1: SSH2_MSG_EXT_INFO received
debug1: kex_input_ext_info: server-sig-algs=<ssh-ed25519,sk-ssh-ed25519@openssh.com,ssh-rsa,rsa-sha2-256,rsa-sha2-512,ssh-dss,ecdsa-sha2-nistp256,ecdsa-sha2-nistp384,ecdsa-sha2-nistp521,sk-ecdsa-sha2-nistp256@openssh.com,webauthn-sk-ecdsa-sha2-nistp256@openssh.com>
debug1: SSH2_MSG_SERVICE_ACCEPT received
debug1: Authentications that can continue: publickey,password
debug1: Next authentication method: publickey
debug1: Trying private key: /home/unix01/.ssh/id_rsa
debug1: Trying private key: /home/unix01/.ssh/id_dsa
debug1: Trying private key: /home/unix01/.ssh/id_ecdsa
debug1: Trying private key: /home/unix01/.ssh/id_ecdsa_sk
debug1: Trying private key: /home/unix01/.ssh/id_ed25519
debug1: Trying private key: /home/unix01/.ssh/id_ed25519_sk
debug1: Trying private key: /home/unix01/.ssh/id_xmss
debug1: Next authentication method: password

--

Guest password.

debug1: SSH2_MSG_SERVICE_ACCEPT received
debug1: Authentications that can continue: publickey,password
debug1: Next authentication method: publickey




-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 


ALEX GAMBIN APUNTES 19.11.21 SSH AGENT - SSH KEYGEN


SSH
[1]
ldap engegat 
pam engegat {instal·lar ssh} {obert port 22 | propagar el port 22 al 2022 2022:22

Genera una imatge que es dirá ssh21:base 
	Aquesta imatge permet engegar containers en detouch.

[2]
LDAP SSH1 SSH2 
Jugar fent connexions ssh 

file client ssh.conf 


The user creates his/her key pair by running ssh-keygen(1). This stores the private key in ~/.ssh/identity (protocol 1), ~/.ssh/id_dsa (protocol 2 DSA), ~/.ssh/id_ecdsa (protocol 2 ECDSA), or ~/.ssh/id_rsa (protocol 2 RSA)

and stores the public key in ~/.ssh/identity.pub (protocol 1), ~/.ssh/id_dsa.pub (protocol 2 DSA), ~/.ssh/id_ecdsa.pub (protocol 2 ECDSA), or ~/.ssh/id_rsa.pub (protocol 2 RSA) in the user's home directory.



Dos tipus de families de #  SHA i MD5

El sshclient ens diu que la máquina contra la que has trucat té un fingerprint. El nostre client no pot asegurar que aquesta es la màquina que diu ser. 

The authenticity of host 'i27 (10.200.243.227)' can't be established.
ECDSA key fingerprint is SHA256:N/Bx0WtXgS1RXliXUPxQFckOyooabdz6EetsEdtkC94.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes

El client ha emmagatzemat el fingerprint y ya no ho preguntarà més.

El fingerprint es calcula a través d’una clau. Aquet # es el # de la clau de host.
Dins del directori .ssh/known_hosts es on es guarden els fingerprints que l’usuari ha donat com acceptables.

ssh-keyscan [ip] → Mostra les claus de host publiques. 

SSH CLIENT
├── ssh_config
├── ssh_config.d 
SSH SERVIDOR
├── sshd_config
├── sshd_config.d
/usr/lib/systemd/system/ssh.service


 ssh-keygen -A generar les claus.


fitxer configuració ssh → ssh_config [client] sshd_config [servidor]


Existeixen 3 nivells de configuració.
/etc/ssh/ssh_config 
~.ssh/config
opcions a la línia de comandes.

El ssh_config son les opcions per defecte.

Host i26
	regles
	regles
[ Cada vegada que ens connectem al i26 se aplicarán les regles ]

ssh_config totes les regles que son aquí 

Host fa referencia al host destí on ens connectem.


pListen 
Bind 


/etc/init.d/ssh start engem el daemon




Clau privada → Format PEM en base 64

Si guardem la clau privada en un joc físic (disc). Si algú consegueix la nostre clau privada ens pot suplantar l’identitat.
El podem guardar xifrat simètric en una passfrase.  → Guardat en memória

El passfrase serveix per desencriptar el fitxer de clau privada. 

Simètric password serveix per desencriptar y encriptar.




Afegir la nostre clau pública. 
ssh-copy-id unix01@ssh.edt.org
/usr/bin/ssh-copy-id: INFO: Source of key(s) to be installed: "/home/pere/.ssh/id_rsa.pub"
The authenticity of host 'ssh.edt.org (172.18.0.2)' can't be established.
ECDSA key fingerprint is SHA256:QQlhSbgJQUa1vYIByh/mkx6zFsae0TRvh1yjvf8tQp8.
Are you sure you want to continue connecting (yes/no/[fingerprint])? yes
/usr/bin/ssh-copy-id: INFO: attempting to log in with the new key(s), to filter out any that are already installed
/usr/bin/ssh-copy-id: INFO: 1 key(s) remain to be installed -- if you are prompted now it is to install the new keys
unix01@ssh.edt.org's password: 

Number of key(s) added: 1

Now try logging into the machine, with:   "ssh 'unix01@ssh.edt.org'"
and check to make sure that only the key(s) you wanted were added.

Per  triar a cada cas quina clau vull utilitzar:

ssh -i .ssh/KeyPackam unix02@ssh.edt.org

$ eval “$(ssh-agent -s)”

Engegar el daemon que permet tenir en memória les claus privades

$ ssh-add .ssh/id_ecdsa

Enter passphrase for .ssh/id_ecdsa: 
Identity added: .ssh/id_ecdsa (pau@i04)
Afegim la clau a memória.

ssh-add -l 

Llistat de claus carregades en memória



ssh -X isx46258230@i27 
Sessió gràfica


# scp copiar
# sftp simular servidor ftp

ssh unix01@ssh.edt.org "uname -a; hostname"
L'ordre la fará dins del container.


$ ps ax | ssh unix01@ssh.edt.org "grep ssh > /tmp/ssh-log
Se ejecuta en la máquina actual y se envia a /tmp/ssh-log de ssh.edt.org 

















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 



















-------------------------------------------------------------------------------- 
